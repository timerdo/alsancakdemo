<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>3D İzmir Stadium - Realistic View</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        #overlay { position: absolute; top: 20px; left: 20px; background: rgba(0,0,0,0.8); color: white; padding: 25px; border-radius: 15px; border: 1px solid #444; }
        .stat-val { font-size: 32px; color: #ff3e3e; font-weight: bold; }
        #sms-btn { position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%); padding: 20px 60px; background: #ff0000; color: white; border: none; border-radius: 50px; font-size: 20px; cursor: pointer; box-shadow: 0 10px 30px rgba(255,0,0,0.4); }
    </style>
</head>
<body>

<div id="overlay">
    <h1 style="margin:0">İzmir Dijital Arena</h1>
    <p>Toplam Kapasite: 10.000</p>
    <div>Dolu Koltuk: <span id="count" class="stat-val">0</span></div>
</div>

<button id="sms-btn" onclick="triggerSMS()">SMS GÖNDER</button>

<script type="importmap">
    { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js", "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/" } }
</script>

<script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x87CEEB); // İzmir Gökyüzü Mavisi
    
    // Sise ekleyerek derinlik hissi veriyoruz
    scene.fog = new THREE.Fog(0x87CEEB, 100, 500);

    const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 2000);
    camera.position.set(120, 100, 150);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.shadowMap.enabled = true;
    document.body.appendChild(renderer.domElement);

    const controls = new OrbitControls(camera, renderer.domElement);
    controls.maxPolarAngle = Math.PI / 2.1; // Kameranın yerin altına girmesini engeller

    // Işıklandırma
    const sun = new THREE.DirectionalLight(0xffffff, 2);
    sun.position.set(100, 200, 100);
    sun.castShadow = true;
    scene.add(sun);
    scene.add(new THREE.AmbientLight(0xffffff, 0.5));

    // SAHA VE ÇİZGİLER
    const fieldGroup = new THREE.Group();
    const grass = new THREE.Mesh(new THREE.PlaneGeometry(80, 120), new THREE.MeshLambertMaterial({color: 0x2d5a27}));
    grass.rotation.x = -Math.PI / 2;
    grass.receiveShadow = true;
    fieldGroup.add(grass);
    scene.add(fieldGroup);

    // TRİBÜN YAPISI
    const seats = [];
    const seatGeo = new THREE.BoxGeometry(0.7, 0.5, 0.7);

    function createCurvedStand(radius, startAng, endAng, rows, heightStep) {
        for (let r = 0; r < rows; r++) {
            const rowRadius = radius + (r * 1.5);
            const rowHeight = r * heightStep;
            const seatCount = Math.floor(rowRadius * (endAng - startAng) * 0.8);

            for (let s = 0; s < seatCount; s++) {
                const angle = startAng + (s / seatCount) * (endAng - startAng);
                const x = Math.cos(angle) * rowRadius;
                const z = Math.sin(angle) * rowRadius;

                const mat = new THREE.MeshLambertMaterial({ color: 0xffffff });
                const seat = new THREE.Mesh(seatGeo, mat);
                seat.position.set(x, rowHeight, z);
                seat.lookAt(0, rowHeight, 0);
                scene.add(seat);
                seats.push(seat);
            }
        }
    }

    // 10.000 Koltuğu Dairesel/Oval Dağıtma (Gerçekçi Stadyum Formu)
    createCurvedStand(60, 0, Math.PI * 2, 22, 0.8);

    // DIŞ DUVAR (Stadyumun kabuğu)
    const wallGeo = new THREE.CylinderGeometry(100, 90, 20, 64, 1, true);
    const wallMat = new THREE.MeshLambertMaterial({ color: 0xcccccc, side: THREE.DoubleSide });
    const wall = new THREE.Mesh(wallGeo, wallMat);
    wall.position.y = 8;
    scene.add(wall);

    // SMS TETİKLEYİCİ
    let currentCount = 0;
    window.triggerSMS = function() {
        for(let i=0; i<50; i++) {
            if(currentCount < seats.length) {
                const target = seats[Math.floor(Math.random() * seats.length)];
                target.material.color.setHex(0xff0000);
                currentCount++;
            }
        }
        document.getElementById('count').innerText = currentCount;
    }

    function animate() {
        requestAnimationFrame(animate);
        controls.update();
        renderer.render(scene, camera);
    }
    animate();

    window.addEventListener('resize', () => {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
</script>
</body>
</html>
